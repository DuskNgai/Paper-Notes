# 2020 RAFT: Recurrent All-Pairs Field Transforms for Optical Flow

## 0 Abstract

RAFT 可提取像素级别的特征，为所有像素对建立多尺度 4D 相关性体像，并利用在相关性体像上进行查找的递归单元迭代更新光流场。

## 1 Introduction

一般来说，优化目标权衡了鼓励视觉上相似的图像区域对齐的数据项和对运动的可信性施加先验的正则化项。这种方法已经取得了相当大的成功，但要取得进一步的进展似乎还具有挑战性，这是因为很难手工设计出一个能够适应各种特殊情况的优化目标。

- 准确性： 在 KITTI 上，RAFT 的 F1 全误差为 5.10%，比已公布的最佳结果（6.10%）减少了 16%。在 Sintel（final pass）上，RAFT 的端点误差为 2.855 像素，比已公布的最佳结果（4.098 像素）减少了 30%。
- 泛化能力： 仅在合成数据上进行训练时，RAFT 在 KITTI 上的终点误差为 5.04 像素，比之前在相同数据上训练的最佳深度网络（8.36 像素）的误差减少了 40%。
- 效率高： RAFT 在 1080Ti GPU 上以每秒 10 帧的速度处理 1088 $\times$ 436 视频。它的训练迭代次数是其他架构的 10 倍。使用 1/5 参数的缩小版 RAFT 在 Sintel 上以每秒 20 帧的速度运行，性能仍优于之前的所有方法。

RAFT 由三个主要部分组成：

1. 一个特征编码器，为每个像素提取一个特征向量；
2. 一个相关层，为所有像素对建立一个 4D 相关性体像，随后汇聚（pooling）成分辨率较低的体像；
3. 一个基于递归 GRU 的更新运算器，从相关性体像中检索值，并迭代更新一个初始值为零的流场。

相比于之前的方法，RAFT：

1. RAFT 维护并更新高分辨率下的单一固定流场。这与以前工作中流行的从粗到细的设计不同，在以前的设计中，首先在低分辨率下估计流场，然后在高分辨率下进行上采样和细化。通过在单个高分辨率流场上运行，RAFT 克服了从粗到细级联的几个局限性：难以从粗分辨率下的错误中恢复、容易遗漏快速移动的小物体，以及通常需要进行大量训练迭代（通常超过 1M 次）来训练多级级联的限制。
2. RAFT 的更新算子是循环的、轻量级的。我们的更新算子只有 2.7M 个参数，在推理过程中可以应用 100 多次而不会出现发散。
3. 更新算子设计新颖，由卷积 GRU 组成，可对四维多尺度相关性体像进行查找；相比之下，之前工作中的优化模块通常只使用普通卷积层或相关层。

## 2 Related Work

## 3 Approach











