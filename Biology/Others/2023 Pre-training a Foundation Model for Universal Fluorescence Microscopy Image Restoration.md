# Pre-training a Foundation Model for Universal Fluorescence Microscopy Image Restoration

## 0 Abstract

用一个基础模型（UniFMIR）实现荧光显微镜图片复原（FMIR），包括超分、去噪、投影、重建。

## 1 Introduction

首先主旨还是荧光显微镜图片复原，肯定了深度学习的手段在荧光显微镜图片领域的作用。然后阐述深度学习方法的几个缺陷
1. 一个 FMIR 模型解决一个问题，数据集小，训练方法也是从头开始训练。
2. UNet 或 RCAN 的网络模型设计太简单了。
3. 泛化性不行，在不同问题不同的数据集上性能下降严重。
4. 领域内对于高质量图像数据集的需求。

本文的主要目的是克服上述弱点，探索 FMIR 深度模型的性能上限，同时为促进后续研究提供启发。然后介绍了基础模型在 NLP、CV 和生命科学中的应用。

作者首先在 DFCAN 上探索了 FMIR 的 Scaling Law。此外，预训练也有很多优点所在
1. 特定任务的训练数据可能有限，而这一问题在荧光显微成像等特定领域更为严重。将预先训练好的 FMIR 模型中的先验知识转移到特定任务或数据模式中，将是一种高效、低成本的解决方案。
2. 很难直接确定手头的现实图像需要哪种类型的 FMIR 操作，因此必须为不同的目标准备多种图像处理模块，这些模块共享一些基本操作。将不同的 FMIR 计算集合到一个基础模型中将更加实用和方便。

UniFMIR 参数量 100M，在 200K 图片数据集上预训练，9 个数据集上调优，10 个数据集测试。网络是多头多尾、主干为 Swin-Transformer。最后在文中语气非常诚恳。

## 2 Discussion

1. UniFMIR 实现了更高的 FMIR 精度，往往优于特定任务的 FMIR 模型。
2. UniFMIR 具有用一个模型处理多个 FMIR 问题的适用性，并能统一恢复不同荧光显微镜的不同数据模式。
3. UniFMIR 显示出令人印象深刻的泛化能力，通过将现有数据集中的知识迁移到新数据中，实现了对新 FMIR 任务的高效训练。

这背后的关键直觉是，基础模型在经过更多样化数据分布的预训练后，可以学习不同高质量图像模式和生物结构的更通用表征。图 7 举例说明了低质量（LQ）图像、重建图像和高质量（HQ）图像的分布空间。我们可以观察到，不同的 FMIR 操作会将 LQ 图像的分布空间（如 LR、各向异性和噪声）推向重建图像的分布空间（虚线圆圈），更接近 HQ 空间（红圈）。与学习 LQ 到 HQ 路径的特定任务 FMIR 模型不同，UniFMIR 趋向于收敛到不同 LQ 空间的共同解空间，因为不同 FMIR 任务的解可以同时规范模型的优化方向，并相互影响，从而得到更精确的解空间，与 HQ 空间相比偏差更小。此外，从一个 FMIR 问题的数据分布中学到的图像修复知识可以指导其他数据模式或任务的知识学习，从而促进更快更好地收敛。

1. 参数量巨大的大型模型往往需要相当数量的训练图像、耗时的预训练和昂贵的计算资源。在更多的训练数据上训练更大的模型可能会进一步提高 FMIR 性能，但会带来更严峻的挑战。
2. 我们利用现有的公共数据集进行预训练，这远远不够。因此，我们需要努力提供更多样、更大量的预训练数据。此外，将更多的数据模式和更多的 FMIR 问题整合到一个多功能模型中具有重要意义。
3. 为了应对新的调频红外问题，需要对新样本进行微调。然而，在零样本条件下，新的训练数据不可用，直接在新样本上应用 UniFMIR 而不更新参数会导致性能下降。我们期待更强大的 FMIR 基础模型在未来的工作中得到广泛应用。

## 3 Method

### Training Details

500 epochs, 5e-5 learning rate, 200 halved after epochs. 1 RTX 3080, batch size 1, patch size 64 * 64.
