# A Foundation Model for Generalizable Disease Detection from Retinal Images

Nature 正刊的切入点会特别大。

## 0 Abstract

医疗 AI 在诊断方面潜力巨大，特别是视网膜的图像的诊断。作者认为当前的难题在于数据标注，以及 domain-specific/task-specific 的数据使得其泛化性较低。因此提出视网膜图像的基础模型 RETFound，其本质就是一个 MAE 模型。那该如何包装这个基础模型呢？就得应用在各种下游任务中，作为便于标记任务的下游任务的基础模型。

## 1 Introduction  

第一段的切入点是，深度神经网络在视网膜图像和 X 光图像分析的准确性方面达到了人类专家的水平。但是人类专家是稀缺的，人类专家来标记图像成本也是非常高昂的，因此开发医疗 AI 辅助是非常有必要的。

第二段讲述自监督模型。自监督模型是从数据中直接获取数据的特征，可以用在大量无标记数据上，比有监督模型更容易进行泛化。训练好了无监督模型之后就可以应用到下游任务中。随后找 CV 中的案例为其背书，特别是 MAE。因此在海量的无标记医疗图像上的潜力巨大。

第三段讲述视网膜图像的现状。CFP (Color Fundus Photography) 图像和 OCT (Optical Coherence Tomography) 图像数据量很大，而且不仅眼科需要，神经内科也可以分析相关图像，甚至普通内科也有需求。然后就可以讲当前自监督模型的缺陷了：

1. 现有的自监督模型还不能泛化到每个需求领域中。
2. 视网膜图像的大型存储库的建立存在挑战。
3. 自监督模型，不管是对比学习还是生成方法，能力和解释性都不足。但退一步讲，特定特征的可解释性是安全可靠地临床落地的重要一步。

第四段就提出了 RETFound，给出了基础模型的定义，针对 CFP (904170) 和 OCT (736442) 各训练了一个 MAE，并将其用在了各种下游任务（疾病监测）：

1. 眼病诊断分类：糖尿病视网膜病变、青光眼。
2. 眼病预后：一年内对侧眼睛向新生血管性年龄相关性黄斑变性的转变。
3. 内科疾病：三年内心血管疾病(缺血性中风、心肌梗死和心力衰竭)和神经退行性疾病(帕金森病)的预测。

作者表示，RETFound 比迁移学习的模型能更好的反映眼科学的相关领域知识。

第五段描述了数据集的来源，以及下游任务的选择。

第六段描述了 RETFound 的 3 个对比模型，每个模型训练方式不同，但架构和在下游任务的调优策略是一致的。

1. SL-ImageNet：在 ImageNet-21k 上监督训练，然后迁移学习。
2. SSL-ImageNet：在 ImageNet-1k 上预训练。
3. SSL-Retinal：在视网膜数据集上预训练。
4. RETFound：用 SSL-ImageNet 的权重再在视网膜数据集上训练。

除了 MAE，还尝试了其他的基础模型（SimCLR, SwAV, DINO, MoCo-v3）。

## 2 Discussion

效果的排名是：RETFound、SL-ImageNet、SSL-ImageNet、SSL-Retinal。

作者注意到，使用 CFP 和 OCT 的模型在预测系统性疾病方面表现不一，这表明 CFP 和 OCT 在眼科任务中包含不同程度的信息。这对医疗服务提供者和成像设备制造商的实际意义在于认识到 CFP 的持续价值，并应将其作为眼科医疗机构标准视网膜评估的一部分。这一观点也鼓励了眼科研究，以调查系统健康与几种图像模式所含信息之间的关联强度。

此外，基础模型还有可能提高医疗人工智能模型的总体质量。采用这些模型有助于避免那些表面上令人印象深刻、但却很少影响临床护理的模型。这些通用性较差的模型耗费了大量资源，并可能使人们对人工智能在医疗保健领域的益处产生怀疑。我们希望通过公开 RETFound，使研究人员能够使用我们的大型数据集设计模型，用于他们自己的机构或探索其他下游应用，从而加快人工智能在医疗领域的发展。

首先，用于开发 RETFound 的大部分数据来自英国的队列，因此值得探讨的是，如果引入一个更大的数据集，将全球的视网膜图像纳入其中，使数据分布更加多样和均衡，会产生怎样的影响。其次，虽然我们研究了 CFP 和 OCT 两种模式的性能，但 CFP 和 OCT 之间的多模式信息融合尚未得到研究，这可能会进一步提高性能。最后，一些与临床相关的信息，如人口统计学和视力，可能会成为眼科和眼底研究的有效协变量，但尚未纳入 SSL 模型。综合这些因素，我们建议在后续迭代中通过引入更大量的图像、探索更多模式以及实现多模式数据的动态交互来进一步增强 RETFound 的实力。

## 3 Result

1.6M 图像，8 A100 (40 GB)，2 周训练时间。调优 1000 张图像在 Tesla T4 上需要 1.2 小时。ViT-L，mask ratio 0.75 for CFP, 0.85 for OCT, batch size 1792。
